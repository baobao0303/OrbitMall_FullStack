/**
 * Request mapper
 */
export class RequestMapper {
    constructor(type) {
        this._target = new type();
        this._propertyMapping = this._target.constructor._propertyMap;
        this._typeList = this._target.constructor._typeList;
    }
    map(source) {
        if (!this._propertyMapping) {
            throw new Error('No properties have been mapped.');
        }
        const requestBody = {};
        for (const propertyKey in this._propertyMapping) {
            if (source.hasOwnProperty(propertyKey)) {
                const snakeCaseKey = this._propertyMapping[propertyKey];
                let value = source[propertyKey];
                if (typeof value === 'object' && value !== null) {
                    if (Array.isArray(value)) {
                        if (this._typeList && this._typeList[propertyKey]) {
                            value = value.map((item) => new RequestMapper(this._typeList[propertyKey]).map(item));
                        }
                    }
                    else {
                        if (this._typeList && this._typeList[propertyKey]) {
                            value = new RequestMapper(this._typeList[propertyKey]).map(value);
                        }
                    }
                }
                requestBody[snakeCaseKey] = value;
            }
        }
        return requestBody;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWVzdC5tYXBwZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb3JlL2Jhc2Uvc3JjL2xpYi9tYXBwZXIvcmVxdWVzdC5tYXBwZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFDSCxNQUFNLE9BQU8sYUFBYTtJQUt4QixZQUFZLElBQW1CO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUMxQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDO1FBQzlELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDO0lBQ3RELENBQUM7SUFFRCxHQUFHLENBQUMsTUFBVztRQUNiLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUMzQixNQUFNLElBQUksS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7UUFDckQsQ0FBQztRQUVELE1BQU0sV0FBVyxHQUFRLEVBQUUsQ0FBQztRQUM1QixLQUFLLE1BQU0sV0FBVyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQ2hELElBQUksTUFBTSxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO2dCQUN2QyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBQ3hELElBQUksS0FBSyxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFFaEMsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksS0FBSyxLQUFLLElBQUksRUFBRSxDQUFDO29CQUNoRCxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzt3QkFDekIsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQzs0QkFDbEQsS0FBSyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUN6QixJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUN6RCxDQUFDO3dCQUNKLENBQUM7b0JBQ0gsQ0FBQzt5QkFBTSxDQUFDO3dCQUNOLElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUM7NEJBQ2xELEtBQUssR0FBRyxJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO3dCQUNwRSxDQUFDO29CQUNILENBQUM7Z0JBQ0gsQ0FBQztnQkFFRCxXQUFXLENBQUMsWUFBWSxDQUFDLEdBQUcsS0FBSyxDQUFDO1lBQ3BDLENBQUM7UUFDSCxDQUFDO1FBQ0QsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSZXF1ZXN0IG1hcHBlclxuICovXG5leHBvcnQgY2xhc3MgUmVxdWVzdE1hcHBlcjxUPiB7XG4gIF9wcm9wZXJ0eU1hcHBpbmc6IGFueTtcbiAgX3R5cGVMaXN0OiBhbnk7XG4gIF90YXJnZXQ6IGFueTtcblxuICBjb25zdHJ1Y3Rvcih0eXBlOiB7IG5ldyAoKTogVCB9KSB7XG4gICAgdGhpcy5fdGFyZ2V0ID0gbmV3IHR5cGUoKTtcbiAgICB0aGlzLl9wcm9wZXJ0eU1hcHBpbmcgPSB0aGlzLl90YXJnZXQuY29uc3RydWN0b3IuX3Byb3BlcnR5TWFwO1xuICAgIHRoaXMuX3R5cGVMaXN0ID0gdGhpcy5fdGFyZ2V0LmNvbnN0cnVjdG9yLl90eXBlTGlzdDtcbiAgfVxuXG4gIG1hcChzb3VyY2U6IGFueSk6IGFueSB7XG4gICAgaWYgKCF0aGlzLl9wcm9wZXJ0eU1hcHBpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gcHJvcGVydGllcyBoYXZlIGJlZW4gbWFwcGVkLicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcXVlc3RCb2R5OiBhbnkgPSB7fTtcbiAgICBmb3IgKGNvbnN0IHByb3BlcnR5S2V5IGluIHRoaXMuX3Byb3BlcnR5TWFwcGluZykge1xuICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eUtleSkpIHtcbiAgICAgICAgY29uc3Qgc25ha2VDYXNlS2V5ID0gdGhpcy5fcHJvcGVydHlNYXBwaW5nW3Byb3BlcnR5S2V5XTtcbiAgICAgICAgbGV0IHZhbHVlID0gc291cmNlW3Byb3BlcnR5S2V5XTtcblxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGVMaXN0ICYmIHRoaXMuX3R5cGVMaXN0W3Byb3BlcnR5S2V5XSkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLm1hcCgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBuZXcgUmVxdWVzdE1hcHBlcih0aGlzLl90eXBlTGlzdFtwcm9wZXJ0eUtleV0pLm1hcChpdGVtKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdHlwZUxpc3QgJiYgdGhpcy5fdHlwZUxpc3RbcHJvcGVydHlLZXldKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0gbmV3IFJlcXVlc3RNYXBwZXIodGhpcy5fdHlwZUxpc3RbcHJvcGVydHlLZXldKS5tYXAodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlcXVlc3RCb2R5W3NuYWtlQ2FzZUtleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcXVlc3RCb2R5O1xuICB9XG59XG4iXX0=